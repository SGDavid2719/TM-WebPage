let deleteCommentFilmIdentifier = void 0,
    deleteCommentIndex = void 0;
async function generatePosters(t) {
    var e = document.getElementById("filmsContainer"),
        n = document.getElementById("portfolioContainer");
    for (l__Index in t)
        generateFilmPoster(e, t[l__Index]),
            await generateFilmModal(n, t[l__Index]),
            createTwitterWidgets(
                t[l__Index].identifier,
                g__Tweets.filter((e) => e.headline == t[l__Index].identifier)
            ),
            setTimeout(
                fetchYoutubeVideo(
                    "Trailer%20" + t[l__Index].name,
                    "youtubeVideo" + l__Index
                ),
                1e4
            );
    const i = [].slice.call(
        document.querySelectorAll('[data-bs-toggle="popover"]')
    );
    i.map(function (e) {
        return new bootstrap.Popover(e);
    }),
        $("#loaderModal").modal("hide");
}
function generateFilmPoster(e, t) {
    const n = document.createElement("div");
    n.setAttribute("id", "film" + t.identifier),
        n.setAttribute("class", "col-lg-4 col-sm-6 mb-4");
    const i = document.createElement("div");
    i.setAttribute("class", "portfolio-item");
    const d = document.createElement("a");
    d.setAttribute("class", "portfolio-link"),
        d.setAttribute("data-bs-toggle", "modal"),
        d.setAttribute("href", "#portfolioModal" + t.identifier);
    const l = document.createElement("img");
    l.setAttribute("class", "img-fluid"),
        l.setAttribute("src", t.image[0].name),
        l.setAttribute("alt", t.name),
        l.setAttribute("width", "504"),
        l.setAttribute("height", "720"),
        d.appendChild(l),
        i.appendChild(d);
    let o = document.createElement("div");
    o.setAttribute("class", "portfolio-caption");
    let a = document.createElement("div");
    a.setAttribute("class", "portfolio-caption-heading");
    var r = document.createTextNode(t.name);
    a.appendChild(r);
    let c = document.createElement("div");
    c.setAttribute("class", "portfolio-caption-subheading");
    t = document.createTextNode(t.releasedEvent.name);
    c.appendChild(t),
        o.appendChild(a),
        o.appendChild(c),
        i.appendChild(o),
        n.appendChild(i),
        e.appendChild(n);
}
async function generateFilmModal(e, t) {
    const n = document.createElement("div");
    n.setAttribute("class", "portfolio-modal modal fade"),
        n.setAttribute("id", "portfolioModal" + t.identifier),
        n.setAttribute("tabindex", "-1"),
        n.setAttribute("role", "dialog"),
        n.setAttribute("aria-hidden", "true");
    const i = document.createElement("div");
    i.setAttribute("class", "modal-dialog");
    const d = document.createElement("div");
    d.setAttribute("class", "modal-content");
    const l = document.createElement("div");
    l.setAttribute("id", "filmCloseModalBtn" + t.identifier),
        l.setAttribute("class", "close-modal"),
        l.setAttribute("data-bs-dismiss", "modal");
    let o = document.createElement("img");
    o.setAttribute("src", "assets/img/close-icon.svg"),
        o.setAttribute("alt", "Close modal"),
        o.setAttribute("aria-label", "Close modal"),
        l.appendChild(o);
    let a = document.createElement("div");
    a.setAttribute("class", "container");
    let r = document.createElement("div");
    r.setAttribute("class", "row");
    let c = document.createElement("h2");
    c.setAttribute("class", "text-uppercase text-lg-center");
    var m = document.createTextNode(t.name);
    c.appendChild(m);
    let s = document.createElement("p");
    s.setAttribute("class", "item-intro text-muted text-lg-center");
    m = document.createTextNode(t.releasedEvent.name);
    s.appendChild(m);
    let u = document.createElement("div");
    u.setAttribute("class", "col-lg-6");
    let p = document.createElement("iframe");
    p.setAttribute("id", "youtubeVideo" + t.identifier),
        p.setAttribute("class", "modalIframe"),
        u.appendChild(p);
    let C = document.createElement("div");
    C.setAttribute("class", "col-lg-6 text-lg-start");
    let b = document.createElement("ul");
    b.setAttribute("class", "list-inline");
    let h = document.createElement("li"),
        f = document.createElement("strong");
    m = document.createTextNode("Duración: ");
    f.appendChild(m);
    m = document.createTextNode(t.duration.name);
    h.appendChild(f), h.appendChild(m), b.appendChild(h);
    let A = document.createElement("li"),
        g = document.createElement("strong");
    m = document.createTextNode("País: ");
    g.appendChild(m);
    m = document.createTextNode(t.countryOfOrigin.name);
    A.appendChild(g), A.appendChild(m), b.appendChild(A);
    let E = document.createElement("li"),
        x = document.createElement("strong");
    m = document.createTextNode("Dirección: ");
    x.appendChild(m);
    m = await createPopover(t.director.name);
    E.appendChild(x), E.appendChild(m), b.appendChild(E);
    let v = document.createElement("li"),
        _ = document.createElement("strong");
    m = document.createTextNode("Música: ");
    _.appendChild(m);
    m = document.createTextNode(t.musicBy.name);
    v.appendChild(_), v.appendChild(m), b.appendChild(v);
    let w = document.createElement("li"),
        y = document.createElement("strong");
    m = document.createTextNode("Reparto: ");
    for (l__Item in (y.appendChild(m), w.appendChild(y), t.actor)) {
        var I = document.createTextNode(t.actor[l__Item].name);
        w.appendChild(I);
    }
    b.appendChild(w);
    let L = document.createElement("li"),
        T = document.createElement("strong");
    m = document.createTextNode("Productora: ");
    T.appendChild(m);
    m = document.createTextNode(t.productionCompany.name);
    L.appendChild(T), L.appendChild(m), b.appendChild(L);
    let N = document.createElement("li"),
        F = document.createElement("strong");
    m = document.createTextNode("Género: ");
    F.appendChild(m);
    let B = "";
    for (l__Item in t.genre) B += t.genre[l__Item].name + ", ";
    m = document.createTextNode(B);
    N.appendChild(F), N.appendChild(m), b.appendChild(N);
    let M = document.createElement("li"),
        k = document.createElement("strong");
    m = document.createTextNode("Sinopsis: ");
    k.appendChild(m);
    m = document.createTextNode(t.description);
    M.appendChild(k), M.appendChild(m), b.appendChild(M), C.appendChild(b);
    let P = document.createElement("div");
    P.setAttribute("id", "opinionSection" + t.identifier);
    let H = document.createElement("form");
    H.setAttribute("class", "text-lg-start row d-none"),
        H.setAttribute("id", "commentForm" + t.identifier);
    let R = document.createElement("div");
    R.setAttribute("class", "col-12 col-lg-6 p-1");
    let S = document.createElement("label");
    S.setAttribute("class", "text-lg-start form-label"),
        S.setAttribute("for", "inputNickname" + t.identifier),
        (S.textContent = "Añade tu nombre");
    let D = document.createElement("input");
    D.setAttribute("type", "text"),
        D.setAttribute("maxlength", "40"),
        D.setAttribute("class", "form-control"),
        D.setAttribute("id", "inputNickname" + t.identifier),
        D.setAttribute("name", "inputNickname" + t.identifier),
        D.setAttribute("aria-describedby", "nameInputHelp"),
        D.setAttribute("placeholder", "p.e. David"),
        D.setAttribute("required", !0),
        D.setAttribute("readonly", !0),
        R.appendChild(S),
        R.appendChild(D),
        H.appendChild(R);
    let $ = document.createElement("div");
    $.setAttribute("class", "col-12 col-lg-6 p-1");
    let j = document.createElement("label");
    j.setAttribute("class", "text-lg-start form-label"),
        j.setAttribute("for", "inputRate" + t.identifier),
        (j.textContent = "Puntuación");
    let z = document.createElement("select");
    z.setAttribute("class", "form-select"),
        z.setAttribute("id", "inputRate" + t.identifier),
        z.setAttribute("name", "inputRate" + t.identifier);
    let U = document.createElement("option");
    U.setAttribute("selected", !0), (U.textContent = "1"), z.appendChild(U);
    let V = document.createElement("option");
    (V.textContent = "2"), z.appendChild(V);
    let q = document.createElement("option");
    (q.textContent = "3"), z.appendChild(q);
    let W = document.createElement("option");
    (W.textContent = "4"), z.appendChild(W);
    let O = document.createElement("option");
    (O.textContent = "5"),
        z.appendChild(O),
        $.appendChild(j),
        $.appendChild(z),
        H.appendChild($);
    let G = document.createElement("div");
    G.setAttribute("class", "col-12 p-1");
    let Q = document.createElement("label");
    Q.setAttribute("class", "text-lg-start form-label"),
        Q.setAttribute("for", "inputComment" + t.identifier),
        (Q.textContent = "Añade un comentario");
    let Y = document.createElement("textarea");
    Y.setAttribute("class", "form-control"),
        Y.setAttribute("id", "inputComment" + t.identifier),
        Y.setAttribute("name", "inputComment" + t.identifier),
        Y.setAttribute("aria-describedby", "opinionTextareaHelp"),
        Y.setAttribute("placeholder", "p.e. Esta película..."),
        Y.setAttribute("required", !0),
        G.appendChild(Q),
        G.appendChild(Y),
        H.appendChild(G);
    let J = document.createElement("div");
    J.setAttribute("id", "commentFormBtn" + t.identifier),
        J.setAttribute("class", "row d-none");
    let K = document.createElement("div");
    K.setAttribute("class", "col-12 p-1 d-flex justify-content-end");
    let X = document.createElement("button");
    X.setAttribute("class", "btn btn-primary"),
        X.setAttribute("id", "addComment" + t.identifier),
        (X.textContent = "Añade tu comentario"),
        K.appendChild(X),
        J.appendChild(K);
    let Z = document.createElement("div");
    Z.setAttribute("id", "loginModalBtn" + t.identifier),
        Z.setAttribute(
            "class",
            "row py-4 px-5 border rounded d-flex justify-content-center"
        );
    let ee = document.createElement("button");
    ee.setAttribute("type", "button"),
        ee.setAttribute("class", "btn btn-primary w-50 text-dark"),
        ee.setAttribute("data-bs-toggle", "modal"),
        ee.setAttribute("data-bs-target", "#userModal"),
        (ee.textContent = "Inicia sesión para dejar un comentario"),
        Z.appendChild(ee);
    let te = document.createElement("div");
    te.setAttribute("class", "row pt-4 p-1"),
        te.setAttribute("id", "commentSection" + t.identifier);
    let ne = document.createElement("div");
    ne.setAttribute("class", "p-3 p-lg-5 scrollviewContent col-12 col-md-7"),
        ne.setAttribute("id", "scrollviewContent" + t.identifier),
        appendComments(ne, t.comment, t.identifier),
        te.appendChild(ne),
        P.appendChild(H),
        P.appendChild(J),
        P.appendChild(Z),
        P.appendChild(te),
        r.appendChild(c),
        r.appendChild(s),
        r.appendChild(u),
        r.appendChild(C),
        r.appendChild(P),
        a.appendChild(r),
        d.appendChild(l),
        d.appendChild(a),
        i.appendChild(d),
        n.appendChild(i),
        e.appendChild(n);
}
function clearPosters() {
    let e = document.getElementById("filmsContainer"),
        t = document.getElementById("portfolioContainer");
    for (; e.firstChild; ) e.removeChild(e.lastChild);
    for (; t.firstChild; ) t.removeChild(t.lastChild);
}
function enablePostersButtons(t) {
    for (var n in t)
        $("#addComment" + t[n].identifier).click(function () {
            handleSubmit(
                "commentForm" + t[n].identifier,
                "scrollviewContent" + t[n].identifier
            );
        }),
            $("#filmCloseModalBtn" + t[n].identifier).click(function (e) {
                document
                    .getElementById("commentForm" + t[n].identifier)
                    .reset(),
                    null != g__Logged__User &&
                        (document.getElementById(
                            "inputNickname" + t[n].identifier
                        ).value = g__Logged__User.name);
            });
}
function appendComments(o, a, r) {
    for (var c in a) {
        let e = document.createElement("div");
        e.setAttribute("class", "card border-dark mx-3 mx-lg-4 pb-3 mb-3");
        let i = document.createElement("div");
        i.setAttribute("class", "card-header fw-bold row m-0");
        let t = document.createElement("div");
        if (
            ((t.textContent = a[c].author.name),
            t.setAttribute("class", "col-6 p-2"),
            i.appendChild(t),
            null != g__Logged__User && g__Logged__User.name == a[c].author.name)
        ) {
            let e = document.createElement("div");
            e.setAttribute("class", "col-6 d-flex justify-content-end");
            let t = document.createElement("button");
            t.setAttribute("id", "film" + r + "edit" + c),
                t.setAttribute("class", "btn border-0"),
                (t.innerHTML =
                    '<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M421.7 220.3L188.5 453.4L154.6 419.5L158.1 416H112C103.2 416 96 408.8 96 400V353.9L92.51 357.4C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6L137.6 429.6C143.1 427.7 149.8 424.2 154.6 419.5L188.5 453.4C178.1 463.8 165.2 471.5 151.1 475.6L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1C.8198 498.8-1.502 489.7 .976 481.2L36.37 360.9C40.53 346.8 48.16 333.9 58.57 323.5L291.7 90.34L421.7 220.3zM492.7 58.75C517.7 83.74 517.7 124.3 492.7 149.3L444.3 197.7L314.3 67.72L362.7 19.32C387.7-5.678 428.3-5.678 453.3 19.32L492.7 58.75z"/></svg>');
            let n = document.createElement("button");
            n.setAttribute("id", "film" + r + "delete" + c),
                n.setAttribute("class", "btn border-0"),
                (n.innerHTML =
                    '<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M135.2 17.69C140.6 6.848 151.7 0 163.8 0H284.2C296.3 0 307.4 6.848 312.8 17.69L320 32H416C433.7 32 448 46.33 448 64C448 81.67 433.7 96 416 96H32C14.33 96 0 81.67 0 64C0 46.33 14.33 32 32 32H128L135.2 17.69zM394.8 466.1C393.2 492.3 372.3 512 346.9 512H101.1C75.75 512 54.77 492.3 53.19 466.1L31.1 128H416L394.8 466.1z"/></svg>'),
                e.appendChild(t),
                e.appendChild(n),
                i.appendChild(e);
        }
        let n = document.createElement("div");
        n.setAttribute("class", "card-body text-dark");
        let d = document.createElement("h5");
        (d.textContent = a[c].contentRating.name + "/5"),
            d.setAttribute("class", "card-title");
        let l = document.createElement("p");
        (l.textContent = a[c].name),
            l.setAttribute("class", "card-text"),
            n.appendChild(d),
            n.appendChild(l),
            e.appendChild(i),
            e.appendChild(n),
            o.appendChild(e),
            $("#film" + r + "edit" + c).click(function (e) {
                console.log("p__Film.identifier: " + r),
                    console.log("l__Comment__Index: " + c),
                    (document.getElementById("inputRate" + r).value =
                        g__Films.filter((e) => e.identifier == r)[0].comment[
                            c
                        ].contentRating.name),
                    (document.getElementById("inputComment" + r).value =
                        g__Films.filter((e) => e.identifier == r)[0].comment[
                            c
                        ].name),
                    handleEditComment(
                        g__Films.filter((e) => e.identifier == r)[0].comment,
                        c,
                        r
                    );
            }),
            $("#film" + r + "delete" + c).click(function (e) {
                (deleteCommentFilmIdentifier = r),
                    (deleteCommentIndex = c),
                    NewAlert(
                        "warning",
                        "¿Quieres borrar este comentario?",
                        " ",
                        !0,
                        "Delete comment",
                        !0
                    );
            });
    }
}
function handleEditComment(e, t, n) {
    e = e.slice();
    e.splice(t, 1),
        (g__Films.filter((e) => e.identifier == n)[0].comment = [...e]),
        saveCommentChanges(g__Films);
}
function handleDeleteComment(t, e) {
    let n = g__Films.filter((e) => e.identifier == t)[0].comment.slice();
    n.splice(e, 1),
        (g__Films.filter((e) => e.identifier == t)[0].comment = [...n]),
        saveCommentChanges(g__Films);
}
async function createPopover(e) {
    var t = await fetchWikipediaInfo(e);
    let n = document.createElement("a");
    return (
        n.setAttribute("tabindex", "0"),
        n.setAttribute("class", "underline underline-offset-1 text-amber-700"),
        n.setAttribute("role", "button"),
        n.setAttribute("data-bs-toggle", "popover"),
        n.setAttribute("data-bs-trigger", "focus"),
        n.setAttribute("data-bs-placement", "right"),
        n.setAttribute("title", e),
        n.setAttribute("data-bs-content", t),
        (n.textContent = e + ", "),
        n
    );
}
function createTwitterWidgets(e, t) {
    let n = document.getElementById("commentSection" + e),
        i = "<p>No tweet avaliable</p>";
    0 < t.length && (i = t[0].sharedContent.text),
        (n.innerHTML += '<div class="col-12 col-md-5 p-3">' + i + "</div>");
}
